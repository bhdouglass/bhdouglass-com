---
import rss from '@astrojs/rss';
import BaseLayout from '../../../layouts/BaseLayout.astro';
import BlogIndex from '../../../components/BlogIndex.astro';
import { sortPosts } from '../../../utilities';
import { TECH_BLOG } from '../../../constants';

import '../../../styles/blog.css';

export async function getStaticPaths({ paginate }) {
  // This is a separate scope, you cannot pass in variables: https://docs.astro.build/en/reference/api-reference/#getstaticpaths
  let posts = sortPosts(await Astro.glob('./*.md'));

  return paginate(posts, { pageSize: 30 });
}

const { page } = Astro.props;
---

<BaseLayout title={`${TECH_BLOG.title} | Page ${page.currentPage}`} feedUrl={TECH_BLOG.feedUrl} siteName={TECH_BLOG.title}>
  <BlogIndex
    title={TECH_BLOG.title}
    tagline={TECH_BLOG.tagline}
    posts={page.data}
    nextUrl={page.url.next}
    prevUrl={page.url.prev}
    feedUrl={TECH_BLOG.feedUrl}
  />
</BaseLayout>
