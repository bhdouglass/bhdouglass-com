---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { sortPosts } from '../../utilities';
import { BLOG } from '../../constants';
import BlogList from '../../components/BlogList.astro';
import Hero from '../../components/Hero.astro';
import { MarkdownInstance, Page } from 'astro';
import { Frontmatter } from '../../types';

export type Props = {
  page: Page<MarkdownInstance<Frontmatter>>;
};

export async function getStaticPaths({ paginate }) {
  // This is a separate scope, you cannot pass in variables: https://docs.astro.build/en/reference/api-reference/#getstaticpaths
  let posts = sortPosts(await Astro.glob('./*.md'));

  return paginate(posts, { pageSize: 15 });
}

const { page } = Astro.props;
---

<BaseLayout pageTitle={`${BLOG.title} | Page ${page.currentPage}`} title={`${BLOG.title} (Page ${page.currentPage})`} siteName={BLOG.title} description={BLOG.tagline}>
  <Hero header={BLOG.title}>
    <h2>by Brian Douglass</h2>
    <h3>{BLOG.tagline}</h3>
  </Hero>

  <BlogList
    posts={page.data}
    nextUrl={page.url.next}
    prevUrl={page.url.prev}
  />
</BaseLayout>
